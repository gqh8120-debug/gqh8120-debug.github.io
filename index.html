<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼ºä¸­å¼ºAIä¸šç»©ç”Ÿæˆå™¨</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ FontAwesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; 
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* é€‰ä¸­çŠ¶æ€çš„æ ·å¼ç±» (JSæ§åˆ¶) */
        .btn-selected {
            background-color: #ea580c !important; /* orange-600 */
            border-color: #f97316 !important; /* orange-500 */
            color: white !important;
            box-shadow: 0 10px 15px -3px rgba(234, 88, 12, 0.3);
        }
        
        /* ç—›ç‚¹é€‰ä¸­æ ·å¼ */
        .pain-point-selected {
            background-color: rgba(239, 68, 68, 0.2) !important;
            border-color: #ef4444 !important;
            color: #fee2e2 !important;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.2);
        }

        body {
            background-color: #0f172a; /* slate-900 */
            color: #f1f5f9; /* slate-100 */
            font-family: system-ui, -apple-system, sans-serif;
        }
    </style>
</head>
<body class="selection:bg-orange-500 selection:text-white min-h-screen">

    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <!-- ä½¿ç”¨æ‚¨ä¸Šä¼ çš„å›¾ç‰‡ -->
                <img src="https://file.rendit.io/n/sF0QvGjW1s9xQ0jK6w8z.jpg" alt="Logo" class="w-10 h-10 rounded-lg object-cover">
                <h1 class="text-xl font-bold tracking-tight text-white">å¼ºä¸­å¼ºAIä¸šç»©ç”Ÿæˆå™¨</h1>
            </div>
            <div class="text-xs font-medium bg-slate-700 px-3 py-1 rounded-full text-slate-300">
                AI é©±åŠ¨ Â· ç»“æœå¯¼å‘
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Left Panel: Inputs -->
            <div class="lg:col-span-4 space-y-6">
                <div class="bg-slate-800 rounded-2xl p-6 border border-slate-700 shadow-xl">
                    <h2 class="text-lg font-semibold text-white mb-6 flex items-center">
                        <i class="fas fa-store w-5 h-5 mr-2 text-orange-500"></i>
                        é—¨åº—åŸºç¡€ä¿¡æ¯
                    </h2>

                    <div class="space-y-5">
                        <!-- é¦†åä¸ç”µè¯ -->
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-slate-400 mb-2 flex items-center">
                                    <i class="fas fa-building w-4 h-4 mr-1 text-slate-500"></i> ç‘œä¼½é¦†åç§°
                                </label>
                                <input type="text" id="studioName" placeholder="ä¾‹å¦‚ï¼šå¼ºä¸­å¼ºç‘œä¼½" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 px-3 text-white focus:ring-2 focus:ring-orange-500 outline-none transition-all text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-400 mb-2 flex items-center">
                                    <i class="fas fa-phone w-4 h-4 mr-1 text-slate-500"></i> è”ç³»ç”µè¯
                                </label>
                                <input type="tel" id="phoneNumber" placeholder="è€æ¿ç”µè¯" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 px-3 text-white focus:ring-2 focus:ring-orange-500 outline-none transition-all text-sm">
                            </div>
                        </div>

                        <!-- åœ°åŒºé€‰æ‹© -->
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2 flex items-center">
                                <i class="fas fa-map-marker-alt w-4 h-4 mr-1 text-slate-500"></i> æ‰€åœ¨åœ°åŒº
                            </label>
                            <div class="grid grid-cols-1 gap-2">
                                <select id="provinceSelect" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 px-3 text-white text-sm"></select>
                                <div class="grid grid-cols-2 gap-2">
                                    <select id="citySelect" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 px-3 text-white text-sm"></select>
                                    <select id="districtSelect" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 px-3 text-white text-sm"></select>
                                </div>
                            </div>
                        </div>

                        <!-- é—¨åº—ç±»å‹ -->
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2">é—¨åº—ç±»å‹</label>
                            <div class="grid grid-cols-4 gap-2" id="storeTypeContainer">
                                <!-- Buttons generated by JS -->
                            </div>
                        </div>

                        <!-- ä¼šå‘˜ç§ç±» -->
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2 flex items-center">
                                <i class="fas fa-dumbbell w-4 h-4 mr-2 text-slate-500"></i> ä¼šå‘˜ç§ç±» (äºº)
                            </label>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-slate-900/50 border border-slate-700 rounded-lg p-2 text-center">
                                    <div class="text-xs text-slate-500 mb-1">å›¢è¯¾</div>
                                    <input type="number" id="memGroup" value="100" class="w-full bg-slate-800 border-slate-600 rounded px-1 py-1 text-center text-sm text-white">
                                </div>
                                <div class="bg-slate-900/50 border border-slate-700 rounded-lg p-2 text-center">
                                    <div class="text-xs text-blue-400 mb-1">å°ç­è¯¾</div>
                                    <input type="number" id="memSmall" value="40" class="w-full bg-slate-800 border-slate-600 rounded px-1 py-1 text-center text-sm text-white">
                                </div>
                                <div class="bg-slate-900/50 border border-slate-700 rounded-lg p-2 text-center">
                                    <div class="text-xs text-orange-400 mb-1">ç§æ•™</div>
                                    <input type="number" id="memPrivate" value="20" class="w-full bg-slate-800 border-slate-600 rounded px-1 py-1 text-center text-sm text-white">
                                </div>
                            </div>
                        </div>

                        <!-- ä¸šç»©ç›®æ ‡ -->
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2">æœ¬æœˆä¸šç»©ç›®æ ‡ (å…ƒ)</label>
                            <div class="relative">
                                <i class="fas fa-bullseye absolute left-3 top-2.5 w-5 h-5 text-slate-500"></i>
                                <input type="number" id="targetRevenue" value="100000" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 pl-10 pr-4 text-white font-mono">
                            </div>
                        </div>

                        <!-- ä»·æ ¼åŒºé—´ -->
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2 flex items-center">
                                <i class="fas fa-credit-card w-4 h-4 mr-2 text-slate-500"></i> ä¸»è¦æˆäº¤å¡é¡¹ä»·æ ¼åŒºé—´
                            </label>
                            <div class="relative">
                                <select id="priceRange" class="w-full bg-slate-900 border border-slate-600 rounded-lg py-2 px-3 text-white text-sm appearance-none">
                                    <option value="low">2000å…ƒä»¥å†…</option>
                                    <option value="mid" selected>2000-5000å…ƒ</option>
                                    <option value="high">5000-10000å…ƒ</option>
                                    <option value="vip">10000å…ƒä»¥ä¸Š</option>
                                </select>
                                <i class="fas fa-chevron-down absolute right-3 top-3 text-slate-500 pointer-events-none text-xs"></i>
                            </div>
                        </div>

                        <!-- ç—›ç‚¹é€‰æ‹© -->
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-2 flex items-center">
                                <i class="fas fa-exclamation-triangle w-4 h-4 mr-2 text-red-500"></i> ç›®å‰æœ€å¤§ç—›ç‚¹ (å¯å¤šé€‰)
                            </label>
                            <div class="grid grid-cols-2 gap-2" id="painPointsContainer">
                                <!-- Generated by JS -->
                            </div>
                        </div>

                        <!-- ç”ŸæˆæŒ‰é’® -->
                        <button id="generateBtn" class="w-full py-4 rounded-xl text-white font-bold text-lg shadow-lg flex items-center justify-center transition-all bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-400 hover:to-red-500 active:scale-95">
                            <i class="fas fa-sparkles w-5 h-5 mr-2"></i> ä¸€é”®ç”Ÿæˆèµšé’±æ–¹æ¡ˆ
                        </button>

                    </div>
                </div>
            </div>

            <!-- Right Panel: Output -->
            <div class="lg:col-span-8 space-y-6" id="outputSection">
                
                <!-- Empty State -->
                <div id="emptyState" class="h-full min-h-[400px] flex flex-col items-center justify-center bg-slate-800/50 border border-dashed border-slate-700 rounded-2xl p-8 text-center">
                    <div class="bg-slate-800 p-4 rounded-full mb-4">
                        <i class="fas fa-calculator text-4xl text-slate-600"></i>
                    </div>
                    <h3 class="text-xl font-medium text-slate-300 mb-2">ç­‰å¾…æ•°æ®è¾“å…¥</h3>
                    <p class="text-slate-500 max-w-sm">è¯·åœ¨å·¦ä¾§è¾“å…¥æ‚¨çš„é—¨åº—æƒ…å†µï¼Œå¼ºä¸­å¼ºæ™ºèƒ½å¤§è„‘å°†ä¸ºæ‚¨ç”Ÿæˆå…¨å¥—è½åœ°æ‰§è¡Œæ–¹æ¡ˆã€‚</p>
                </div>

                <!-- Generated Content (Hidden by default) -->
                <div id="generatedContent" class="space-y-6 hidden">
                    
                    <!-- 1. Strategy Card -->
                    <div class="bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden shadow-xl fade-in">
                        <div class="bg-slate-900/50 px-6 py-4 border-b border-slate-700 flex justify-between items-center">
                            <h3 class="text-lg font-bold text-orange-500 flex items-center">
                                <span class="bg-orange-500/10 p-1.5 rounded mr-2">ğŸ¯</span> æ´»åŠ¨é¡¶å±‚è®¾è®¡
                            </h3>
                            <div class="text-xs text-slate-500 bg-slate-800 px-2 py-1 rounded border border-slate-700" id="strategyLocation"></div>
                        </div>
                        <div class="p-6">
                            <div class="mb-4">
                                <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Activity Theme</span>
                                <h4 class="text-2xl font-bold text-white mt-1" id="strategyTheme"></h4>
                            </div>
                            <div class="bg-slate-700/30 p-4 rounded-xl border border-slate-700">
                                <span class="text-xs font-bold text-orange-400 uppercase tracking-wider block mb-2">åº•å±‚é€»è¾‘</span>
                                <p class="text-slate-300 leading-relaxed" id="strategyLogic"></p>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Card Matrix (Table) -->
                    <div class="bg-slate-800 rounded-2xl border border-slate-700 p-6 shadow-xl fade-in">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                            <i class="fas fa-check-circle w-5 h-5 mr-2 text-blue-500"></i> æ¨èå¡é¡¹è®¾è®¡ (AI å®šåˆ¶)
                        </h3>
                        <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 mb-6 text-xs text-blue-200 leading-relaxed whitespace-pre-wrap">
                            <span class="font-bold text-blue-400">ğŸ’¡ è®¾è®¡æ€è·¯ï¼š</span><span id="cardDesignLogic"></span>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-collapse min-w-[800px]">
                                <thead>
                                    <tr class="border-b border-slate-700 text-slate-400 text-xs font-bold uppercase">
                                        <th class="p-3">å¡ç±»å‹</th>
                                        <th class="p-3">å¡åç¤ºä¾‹</th>
                                        <th class="p-3">å†…å®¹é…ç½®</th>
                                        <th class="p-3">å»ºè®®å”®ä»·åŒºé—´</th>
                                        <th class="p-3">å•èŠ‚æŠ˜ç®—(å‚è€ƒ)</th>
                                        <th class="p-3">é€‚ç”¨å®¢æˆ·</th>
                                        <th class="p-3">å®šä½è¯´æ˜</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-700" id="cardTableBody">
                                    <!-- JS render -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 3. Revenue Funnel -->
                    <div class="bg-slate-800 rounded-2xl border border-slate-700 p-6 shadow-xl relative overflow-hidden group fade-in">
                        <div class="absolute top-0 right-0 p-4 opacity-10">
                            <i class="fas fa-calculator text-8xl text-white"></i>
                        </div>
                        <h3 class="text-lg font-bold text-white mb-6 flex items-center">
                            <i class="fas fa-filter w-5 h-5 mr-2 text-green-500"></i> ä¸šç»©åæ¨æ¼æ–—
                        </h3>
                        <div class="flex items-center justify-between text-center mb-6 text-sm relative z-10 flex-wrap gap-2">
                            <div class="flex-1 min-w-[100px]">
                                <div class="text-slate-400 mb-1">æ‰€éœ€è¿›åº—æµé‡</div>
                                <div class="text-xl font-bold text-blue-400"><span id="mathLeads"></span><span class="text-xs text-slate-500 ml-1">äºº</span></div>
                            </div>
                            <div class="text-slate-600 font-bold text-lg">Ã—</div>
                            <div class="flex-1 min-w-[100px]">
                                <div class="text-slate-400 mb-1">å¹³å‡å®¢å•ä»·</div>
                                <div class="text-xl font-bold text-orange-400" id="mathTicket"></div>
                            </div>
                            <div class="text-slate-600 font-bold text-lg">Ã—</div>
                            <div class="flex-1 min-w-[100px]">
                                <div class="text-slate-400 mb-1">é¢„ä¼°è´­ä¹°ç‡</div>
                                <div class="text-xl font-bold text-purple-400" id="mathRate"></div>
                            </div>
                            <div class="text-slate-600 font-bold text-lg">=</div>
                            <div class="flex-1 min-w-[120px] bg-slate-700/50 rounded-lg py-2 border border-slate-600">
                                <div class="text-slate-300 mb-1">ç›®æ ‡ä¸šç»©</div>
                                <div class="text-xl font-bold text-white" id="mathTarget"></div>
                            </div>
                        </div>
                        <div class="bg-slate-900/50 p-3 rounded-lg text-xs text-slate-400 whitespace-pre-line" id="mathComment"></div>
                    </div>

                    <!-- 4. Content Calendar -->
                    <div class="bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden shadow-xl fade-in">
                        <div class="bg-slate-900/50 px-6 py-4 border-b border-slate-700 flex justify-between items-center">
                            <h3 class="text-lg font-bold text-green-500 flex items-center">
                                <i class="fas fa-share-alt w-5 h-5 mr-2"></i> å…¨åŸŸæµé‡æ—¥å† (æ¯æ—¥æ›´æ–°)
                            </h3>
                            <div class="flex items-center space-x-2 bg-slate-800 rounded-lg p-1 border border-slate-600">
                                <button onclick="changeDate(-1)" class="p-1 hover:bg-slate-700 rounded text-slate-400"><i class="fas fa-chevron-left"></i></button>
                                <div class="flex items-center px-2 text-sm font-mono text-white min-w-[100px] justify-center">
                                    <i class="far fa-calendar-alt w-3 h-3 mr-2 text-green-500"></i>
                                    <span id="calendarDateDisplay"></span>
                                </div>
                                <button onclick="changeDate(1)" class="p-1 hover:bg-slate-700 rounded text-slate-400"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        <div class="p-6 space-y-8">
                            <!-- WeChat -->
                            <div>
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider flex items-center">
                                        <i class="fab fa-weixin w-4 h-4 mr-2"></i> æœ‹å‹åœˆè·Ÿå• (3æ¡/æ—¥)
                                    </h4>
                                    <span class="text-xs px-2 py-1 bg-slate-700 rounded text-orange-300" id="dailyVibeTag"></span>
                                </div>
                                <div class="space-y-6" id="momentsContainer">
                                    <!-- Generated Moments -->
                                </div>
                            </div>

                            <!-- Douyin -->
                            <div class="pt-6 border-t border-slate-700">
                                <h4 class="text-sm font-bold text-slate-400 mb-4 uppercase tracking-wider flex items-center">
                                    <i class="fab fa-tiktok w-4 h-4 mr-2"></i> æŠ–éŸ³çŸ­è§†é¢‘ (1æ¡/æ—¥)
                                </h4>
                                <div class="bg-slate-900 rounded-xl border border-slate-700 p-5 relative">
                                    <div class="flex justify-between items-start mb-4">
                                        <div>
                                            <span class="inline-block bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-1 rounded font-bold mb-2">ä»Šæ—¥æ¨è</span>
                                            <h5 class="text-lg font-bold text-white" id="douyinTitle"></h5>
                                        </div>
                                        <button onclick="copyText('douyinContent')" class="p-2 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white"><i class="fas fa-copy"></i></button>
                                    </div>
                                    <div class="bg-slate-800/50 p-4 rounded-lg mb-4 text-sm text-slate-300 whitespace-pre-line border border-slate-700/50" id="douyinContent"></div>
                                    <div class="mb-4 flex items-center text-xs text-slate-400 bg-slate-800 px-3 py-2 rounded border border-slate-700">
                                        <i class="fas fa-music w-3 h-3 mr-2 text-purple-400"></i> æ¨èBGMï¼š<span class="text-purple-300 ml-1" id="douyinBgm"></span>
                                    </div>
                                    <div class="space-y-2" id="douyinScript">
                                        <!-- Script Lines -->
                                    </div>
                                </div>
                            </div>

                            <!-- Xiaohongshu -->
                            <div class="pt-6 border-t border-slate-700">
                                <h4 class="text-sm font-bold text-slate-400 mb-4 uppercase tracking-wider flex items-center">
                                    <i class="fas fa-camera w-4 h-4 mr-2"></i> å°çº¢ä¹¦ç¬”è®° (1æ¡/æ—¥)
                                </h4>
                                <div class="bg-slate-900 rounded-xl border border-slate-700 p-5 relative">
                                    <div class="flex justify-between items-start mb-4">
                                        <div>
                                            <span class="inline-block bg-red-500 text-white text-xs px-2 py-1 rounded font-bold mb-2">çˆ†æ¬¾ç¬”è®°</span>
                                            <h5 class="text-lg font-bold text-white" id="xhsTitle"></h5>
                                        </div>
                                        <button onclick="copyText('xhsContent')" class="p-2 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white"><i class="fas fa-copy"></i></button>
                                    </div>
                                    <div class="bg-slate-800/50 p-4 rounded-lg mb-4 text-sm text-slate-300 whitespace-pre-line border border-slate-700/50" id="xhsContent"></div>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2" id="xhsImages">
                                        <!-- Images -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Private Scripts -->
                    <div class="bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden shadow-xl fade-in">
                        <div class="bg-slate-900/50 px-6 py-4 border-b border-slate-700">
                            <h3 class="text-lg font-bold text-purple-500 flex items-center"><i class="fas fa-comments w-5 h-5 mr-2"></i> ç§åŸŸç²¾å‡†è¯æœ¯ (å››ç±»å®¢ç¾¤)</h3>
                        </div>
                        <div class="divide-y divide-slate-700" id="privateScriptsContainer">
                            <!-- Scripts -->
                        </div>
                    </div>

                    <!-- 6. AI Chat -->
                    <div class="bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden shadow-xl fade-in">
                        <div class="bg-slate-900/50 px-6 py-4 border-b border-slate-700 flex justify-between items-center">
                            <h3 class="text-lg font-bold text-blue-400 flex items-center"><i class="fas fa-robot w-5 h-5 mr-2"></i> å¼ºä¸­å¼ºÂ·AI è¿è¥é¡¾é—®</h3>
                        </div>
                        <div class="p-6">
                            <div class="flex flex-wrap gap-2 mb-4" id="presetQuestions">
                                <!-- Preset Questions -->
                            </div>
                            
                            <div id="aiResponseContainer" class="mb-4 bg-slate-700/50 rounded-lg p-4 border border-slate-600 hidden">
                                <div class="flex items-start mb-2">
                                    <div class="bg-blue-500/20 p-1 rounded mr-2"><i class="fas fa-magic w-4 h-4 text-blue-400"></i></div>
                                    <span class="text-sm font-bold text-blue-100">AI å»ºè®®æ–¹æ¡ˆï¼š</span>
                                </div>
                                <div class="text-sm text-slate-300 font-mono whitespace-pre-line pl-8 leading-relaxed" id="aiResponseText"></div>
                            </div>

                            <div class="relative">
                                <textarea id="qaInput" placeholder="åœ¨æ­¤è¾“å…¥æ‚¨çš„ç»è¥éš¾é¢˜ï¼ˆä¾‹å¦‚ï¼šæœ€è¿‘ä½“éªŒè¯¾è½¬åŒ–ç‡å¾ˆä½æ€ä¹ˆåŠï¼Ÿï¼‰..." class="w-full bg-slate-900 border border-slate-600 rounded-xl py-3 pl-4 pr-12 text-white focus:ring-2 focus:ring-blue-500 outline-none resize-none h-24 text-sm"></textarea>
                                <button onclick="handleAskAI()" id="qaBtn" class="absolute bottom-3 right-3 p-2 rounded-lg transition-colors bg-blue-600 hover:bg-blue-500 text-white shadow-lg">
                                    <i class="fas fa-paper-plane w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </main>

    <script>
        // --- Data Sources ---
        const CHINA_REGIONS = {
            "åŒ—äº¬å¸‚": { "åŒ—äº¬å¸‚": ["æœé˜³åŒº", "æµ·æ·€åŒº", "è¥¿åŸåŒº", "ä¸œåŸåŒº", "ä¸°å°åŒº", "çŸ³æ™¯å±±åŒº", "é—¨å¤´æ²ŸåŒº", "æˆ¿å±±åŒº", "é€šå·åŒº", "é¡ºä¹‰åŒº", "æ˜Œå¹³åŒº", "å¤§å…´åŒº", "æ€€æŸ”åŒº", "å¹³è°·åŒº", "å¯†äº‘åŒº", "å»¶åº†åŒº"] },
            "ä¸Šæµ·å¸‚": { "ä¸Šæµ·å¸‚": ["æµ¦ä¸œæ–°åŒº", "é»„æµ¦åŒº", "å¾æ±‡åŒº", "é•¿å®åŒº", "é™å®‰åŒº", "æ™®é™€åŒº", "è™¹å£åŒº", "æ¨æµ¦åŒº", "é—µè¡ŒåŒº", "å®å±±åŒº", "å˜‰å®šåŒº", "é‡‘å±±åŒº", "æ¾æ±ŸåŒº", "é’æµ¦åŒº", "å¥‰è´¤åŒº", "å´‡æ˜åŒº"] },
            "å¹¿ä¸œçœ": { 
                "æ·±åœ³å¸‚": ["ç¦ç”°åŒº", "ç½—æ¹–åŒº", "å—å±±åŒº", "ç›ç”°åŒº", "å®å®‰åŒº", "é¾™å²—åŒº", "é¾™ååŒº", "åªå±±åŒº", "å…‰æ˜åŒº"], 
                "å¹¿å·å¸‚": ["å¤©æ²³åŒº", "è¶Šç§€åŒº", "æµ·ç åŒº", "è”æ¹¾åŒº", "ç™½äº‘åŒº", "é»„åŸ”åŒº", "ç•ªç¦ºåŒº", "èŠ±éƒ½åŒº", "å—æ²™åŒº", "ä»åŒ–åŒº", "å¢åŸåŒº"], 
                "ä¸œèå¸‚": ["ä¸œåŸè¡—é“", "å—åŸè¡—é“", "ä¸‡æ±Ÿè¡—é“", "èåŸè¡—é“", "æ¾å±±æ¹–", "é•¿å®‰é•‡", "è™é—¨é•‡", "å¸¸å¹³é•‡"], 
                "ä½›å±±å¸‚": ["ç¦…åŸåŒº", "å—æµ·åŒº", "é¡ºå¾·åŒº", "é«˜æ˜åŒº", "ä¸‰æ°´åŒº"],
                "ç æµ·å¸‚": ["é¦™æ´²åŒº", "æ–—é—¨åŒº", "é‡‘æ¹¾åŒº"],
                "æƒ å·å¸‚": ["æƒ åŸåŒº", "æƒ é˜³åŒº", "åšç½—å¿", "æƒ ä¸œå¿", "é¾™é—¨å¿"],
                "ä¸­å±±å¸‚": ["çŸ³å²è¡—é“", "ä¸œåŒºè¡—é“", "è¥¿åŒºè¡—é“", "å—åŒºè¡—é“", "äº”æ¡‚å±±è¡—é“", "å°æ¦„é•‡"]
            },
            "æµ™æ±Ÿçœ": { "æ­å·å¸‚": ["ä¸ŠåŸåŒº", "æ‹±å¢…åŒº", "è¥¿æ¹–åŒº", "æ»¨æ±ŸåŒº", "è§å±±åŒº", "ä½™æ­åŒº", "ä¸´å¹³åŒº", "é’±å¡˜åŒº", "å¯Œé˜³åŒº", "ä¸´å®‰åŒº"], "å®æ³¢å¸‚": ["æµ·æ›™åŒº", "æ±ŸåŒ—åŒº", "åŒ—ä»‘åŒº", "é•‡æµ·åŒº", "é„å·åŒº", "å¥‰åŒ–åŒº"], "æ¸©å·å¸‚": ["é¹¿åŸåŒº", "é¾™æ¹¾åŒº", "ç“¯æµ·åŒº", "æ´å¤´åŒº"] },
            "æ±Ÿè‹çœ": { "å—äº¬å¸‚": ["ç„æ­¦åŒº", "ç§¦æ·®åŒº", "å»ºé‚ºåŒº", "é¼“æ¥¼åŒº", "æµ¦å£åŒº", "æ –éœåŒº", "é›¨èŠ±å°åŒº", "æ±Ÿå®åŒº", "å…­åˆåŒº", "æº§æ°´åŒº", "é«˜æ·³åŒº"], "è‹å·å¸‚": ["å§‘è‹åŒº", "è™ä¸˜åŒº", "å´ä¸­åŒº", "ç›¸åŸåŒº", "å´æ±ŸåŒº", "æ˜†å±±å¸‚", "å¸¸ç†Ÿå¸‚"] },
            "å››å·çœ": { "æˆéƒ½å¸‚": ["é”¦æ±ŸåŒº", "é’ç¾ŠåŒº", "é‡‘ç‰›åŒº", "æ­¦ä¾¯åŒº", "æˆååŒº", "é¾™æ³‰é©¿åŒº", "é’ç™½æ±ŸåŒº", "æ–°éƒ½åŒº", "æ¸©æ±ŸåŒº", "åŒæµåŒº", "éƒ«éƒ½åŒº"] },
            "æ¹–åŒ—çœ": { "æ­¦æ±‰å¸‚": ["æ±Ÿå²¸åŒº", "æ±Ÿæ±‰åŒº", "ç¡šå£åŒº", "æ±‰é˜³åŒº", "æ­¦æ˜ŒåŒº", "é’å±±åŒº", "æ´ªå±±åŒº", "ä¸œè¥¿æ¹–åŒº", "æ±‰å—åŒº", "è”¡ç”¸åŒº", "æ±Ÿå¤åŒº", "é»„é™‚åŒº", "æ–°æ´²åŒº"] },
            "æ¹–å—çœ": { "é•¿æ²™å¸‚": ["èŠ™è“‰åŒº", "å¤©å¿ƒåŒº", "å²³éº“åŒº", "å¼€ç¦åŒº", "é›¨èŠ±åŒº", "æœ›åŸåŒº", "é•¿æ²™å¿", "æµé˜³å¸‚", "å®ä¹¡å¸‚"] },
            "å±±ä¸œçœ": { "æµå—å¸‚": ["å†ä¸‹åŒº", "å¸‚ä¸­åŒº", "æ§è«åŒº", "å¤©æ¡¥åŒº", "å†åŸåŒº", "é•¿æ¸…åŒº", "ç« ä¸˜åŒº", "æµé˜³åŒº", "è±èŠœåŒº", "é’¢åŸåŒº"], "é’å²›å¸‚": ["å¸‚å—åŒº", "å¸‚åŒ—åŒº", "é»„å²›åŒº", "å´‚å±±åŒº", "ææ²§åŒº", "åŸé˜³åŒº", "å³å¢¨åŒº"] },
            "ç¦å»ºçœ": { "ç¦å·å¸‚": ["é¼“æ¥¼åŒº", "å°æ±ŸåŒº", "ä»“å±±åŒº", "é©¬å°¾åŒº", "æ™‹å®‰åŒº", "é•¿ä¹åŒº"], "å¦é—¨å¸‚": ["æ€æ˜åŒº", "æµ·æ²§åŒº", "æ¹–é‡ŒåŒº", "é›†ç¾åŒº", "åŒå®‰åŒº", "ç¿”å®‰åŒº"] },
            "å®‰å¾½çœ": { "åˆè‚¥å¸‚": ["ç‘¶æµ·åŒº", "åºé˜³åŒº", "èœ€å±±åŒº", "åŒ…æ²³åŒº"] },
            "é™•è¥¿çœ": { "è¥¿å®‰å¸‚": ["æ–°åŸåŒº", "ç¢‘æ—åŒº", "è²æ¹–åŒº", "çæ¡¥åŒº", "æœªå¤®åŒº", "é›å¡”åŒº", "é˜è‰¯åŒº", "ä¸´æ½¼åŒº", "é•¿å®‰åŒº", "é«˜é™µåŒº", "é„ é‚‘åŒº"] },
            "å¤©æ´¥å¸‚": { "å¤©æ´¥å¸‚": ["å’Œå¹³åŒº", "æ²³ä¸œåŒº", "æ²³è¥¿åŒº", "å—å¼€åŒº", "æ²³åŒ—åŒº", "çº¢æ¡¥åŒº", "æ»¨æµ·æ–°åŒº"] },
            "é‡åº†å¸‚": { "é‡åº†å¸‚": ["æ¸ä¸­åŒº", "æ±ŸåŒ—åŒº", "å—å²¸åŒº", "ä¹é¾™å¡åŒº", "æ²™åªååŒº", "å¤§æ¸¡å£åŒº", "åŒ—ç¢šåŒº", "æ¸åŒ—åŒº", "å·´å—åŒº"] },
            // çœç•¥éƒ¨åˆ†å†·é—¨åŸå¸‚ä»¥èŠ‚çœç©ºé—´ï¼Œä½†é€»è¾‘å…¼å®¹æ‰€æœ‰
        };

        const STORE_TYPE_OPTIONS = [
            { id: 'mall', label: 'å•†åœºé¦†', desc: 'é«˜æ›å…‰' },
            { id: 'office', label: 'å†™å­—æ¥¼', desc: 'ç™½é¢†å¤š' },
            { id: 'community', label: 'ç¤¾åŒºåº—', desc: 'åšé•¿æœŸ' },
            { id: 'studio', label: 'å·¥ä½œå®¤', desc: 'é«˜å®¢å•' }
        ];

        const PAIN_POINTS_OPTIONS = [
            "ä¸¥é‡ç¼ºæ–°å®¢", "è€å®¢æ­»å¾—å¿«", "ä½“éªŒè½¬ä¸åŠ¨", "å¤§è¯¾æ²¡äººä¸Š", "ç§æ•™å–ä¸å‡º",
            "å¡é¡¹ä¸èµšé’±", "æ•™ç»ƒä¸ä¼šé”€", "ç¾å›¢æ²¡äººç†", "æˆ¿ç§Ÿå‹åŠ›å¤§", "æ·¡å­£ç©ºè¡è¡"
        ];

        const PRESET_QA_TAGS = ["æ–°åº—å¦‚ä½•å¼•æµï¼Ÿ", "è€ä¼šå‘˜ä¸ç»­è´¹ï¼Ÿ", "ç§æ•™è¯¾æ€ä¹ˆå–ï¼Ÿ", "æ•™ç»ƒå›¢é˜Ÿç®¡ç†ï¼Ÿ", "æ·¡å­£ä¸šç»©ä¸‹æ»‘ï¼Ÿ"];

        const PRICE_RANGE_OPTIONS = [
            { id: 'low', label: '2000å…ƒä»¥å†…', avg: 1500 },
            { id: 'mid', label: '2000-5000å…ƒ', avg: 3500 },
            { id: 'high', label: '5000-10000å…ƒ', avg: 7500 },
            { id: 'vip', label: '10000å…ƒä»¥ä¸Š', avg: 15000 },
        ];

        const WEEKLY_THEMES = [
            { day: 'å‘¨æ—¥', theme: 'å¤ç›˜ä¸è§„åˆ’', mood: 'Relaxed' },
            { day: 'å‘¨ä¸€', theme: 'èƒ½é‡å”¤é†’', mood: 'Energetic' },
            { day: 'å‘¨äºŒ', theme: 'å¹²è´§çŸ¥è¯†', mood: 'Professional' },
            { day: 'å‘¨ä¸‰', theme: 'ä¼šå‘˜æ¡ˆä¾‹', mood: 'Trust' },
            { day: 'å‘¨å››', theme: 'æƒ…ç»ªè§£å‹', mood: 'Healing' },
            { day: 'å‘¨äº”', theme: 'å‘¨æœ«é¢„å‘Š', mood: 'Exciting' },
            { day: 'å‘¨å…­', theme: 'ç”Ÿæ´»æ–¹å¼', mood: 'Lifestyle' },
        ];
        
        const DAILY_VIBES = [
          { id: 1, name: "ç¡¬æ ¸å¹²è´§æ—¥" },
          { id: 2, name: "æƒ…æ„Ÿå…±é¸£æ—¥" },
          { id: 3, name: "ç¦åˆ©è½°ç‚¸æ—¥" },
          { id: 4, name: "ä¼šå‘˜é«˜å…‰æ—¥" },
          { id: 5, name: "ç”Ÿæ´»ç¾å­¦æ—¥" },
          { id: 6, name: "ç¤¾äº¤äº’åŠ¨æ—¥" },
          { id: 7, name: "æ•™ç»ƒé£é‡‡æ—¥" },
          { id: 8, name: "æ²‰æµ¸ä½“éªŒæ—¥" },
          { id: 9, name: "ç—›ç‚¹ç›´å‡»æ—¥" },
          { id: 10, name: "è½»æ¾èººå¹³æ—¥" },
        ];

        // --- State ---
        let state = {
            province: 'å¹¿ä¸œçœ',
            city: 'æ·±åœ³å¸‚',
            district: 'å—å±±åŒº',
            storeType: 'mall',
            priceRange: 'mid',
            selectedPainPoints: [],
            targetRevenue: 100000,
            currentDate: new Date(),
            memberCounts: { group: 100, small: 40, private: 20 },
            result: null
        };

        // --- Init ---
        function init() {
            renderRegions();
            renderStoreTypes();
            renderPainPoints();
            renderPresetQA();
            
            // Listeners
            document.getElementById('provinceSelect').addEventListener('change', (e) => updateRegion(e.target.value));
            document.getElementById('citySelect').addEventListener('change', (e) => updateCity(e.target.value));
            document.getElementById('generateBtn').addEventListener('click', handleGenerate);
            document.getElementById('priceRange').addEventListener('change', (e) => state.priceRange = e.target.value);
            document.getElementById('targetRevenue').addEventListener('input', (e) => state.targetRevenue = e.target.value);
            
            // Init Defaults
            updateRegion(state.province);
        }

        // --- Renders ---
        function renderRegions() {
            const pSelect = document.getElementById('provinceSelect');
            pSelect.innerHTML = Object.keys(CHINA_REGIONS).map(p => `<option value="${p}">${p}</option>`).join('');
            pSelect.value = state.province;
        }

        function updateRegion(prov) {
            state.province = prov;
            const cities = Object.keys(CHINA_REGIONS[prov] || {});
            const cSelect = document.getElementById('citySelect');
            cSelect.innerHTML = cities.map(c => `<option value="${c}">${c}</option>`).join('');
            state.city = cities[0];
            updateCity(cities[0]);
        }

        function updateCity(ct) {
            state.city = ct;
            const districts = CHINA_REGIONS[state.province][ct] || [];
            const dSelect = document.getElementById('districtSelect');
            dSelect.innerHTML = districts.map(d => `<option value="${d}">${d}</option>`).join('');
            state.district = districts[0];
        }

        function renderStoreTypes() {
            const container = document.getElementById('storeTypeContainer');
            container.innerHTML = STORE_TYPE_OPTIONS.map(t => `
                <button onclick="setStoreType('${t.id}')" class="store-btn flex flex-col items-center justify-center py-3 px-1 rounded-xl border transition-all relative group h-20 ${state.storeType === t.id ? 'btn-selected' : 'bg-slate-700/50 border-slate-600 text-slate-300'}">
                    <span class="font-bold text-xs mb-1 text-center leading-tight">${t.label}</span>
                    <span class="text-[10px] text-center transform scale-90 opacity-75">${t.desc}</span>
                    ${state.storeType === t.id ? '<i class="fas fa-check-circle absolute top-1 right-1 text-xs"></i>' : ''}
                </button>
            `).join('');
        }

        function setStoreType(id) {
            state.storeType = id;
            renderStoreTypes();
        }

        function renderPainPoints() {
            const container = document.getElementById('painPointsContainer');
            container.innerHTML = PAIN_POINTS_OPTIONS.map(p => `
                <button onclick="togglePainPoint('${p}')" class="text-xs py-2 px-1 rounded-md border transition-all ${state.selectedPainPoints.includes(p) ? 'pain-point-selected' : 'bg-slate-800 border-slate-700 text-slate-400'}">
                    ${p}
                </button>
            `).join('');
        }

        function togglePainPoint(p) {
            if (state.selectedPainPoints.includes(p)) {
                state.selectedPainPoints = state.selectedPainPoints.filter(item => item !== p);
            } else {
                state.selectedPainPoints.push(p);
            }
            renderPainPoints();
        }

        function renderPresetQA() {
            document.getElementById('presetQuestions').innerHTML = PRESET_QA_TAGS.map(tag => 
                `<button onclick="askAI('${tag}')" class="text-xs bg-slate-700 hover:bg-blue-600 hover:text-white text-slate-300 px-3 py-1.5 rounded-full transition-colors border border-slate-600">${tag}</button>`
            ).join('');
        }

        // --- Core Logic ---
        function handleGenerate() {
            if(!state.targetRevenue || state.selectedPainPoints.length === 0) {
                alert("è€æ¿ï¼Œè¯·å¡«å†™ä¸šç»©ç›®æ ‡å¹¶è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ ¸å¿ƒç—›ç‚¹ï¼");
                return;
            }

            // Loading visual
            const btn = document.getElementById('generateBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> æ­£åœ¨æ¨æ¼”ç­–ç•¥...';
            btn.disabled = true;

            setTimeout(() => {
                generateResult();
                btn.innerHTML = originalText;
                btn.disabled = false;
                document.getElementById('emptyState').classList.add('hidden');
                document.getElementById('generatedContent').classList.remove('hidden');
                window.scrollTo({ top: document.getElementById('outputSection').offsetTop, behavior: 'smooth' });
            }, 1200);
        }

        function generateResult() {
            // Gather inputs
            const shopName = document.getElementById('studioName').value || 'å¼ºä¸­å¼ºç‘œä¼½';
            const totalMembers = parseInt(document.getElementById('memGroup').value) + parseInt(document.getElementById('memSmall').value) + parseInt(document.getElementById('memPrivate').value);
            
            const priceOpt = PRICE_RANGE_OPTIONS.find(p => p.id === state.priceRange);
            const avgTicket = priceOpt.avg;
            const closeRate = state.storeType === 'studio' ? 0.35 : 0.20;
            const neededLeads = Math.ceil(state.targetRevenue / (avgTicket * closeRate));
            const neededSales = Math.ceil(state.targetRevenue / avgTicket);

            // Strategy Logic
            let theme = "å…¨åŸçƒ­ç»ƒ";
            let logic = "é€šè¿‡å¤šç»´åº¦è¥é”€ç»„åˆæ‹³ï¼Œæ‰“ç ´æµé‡ç“¶é¢ˆã€‚";
            if (state.selectedPainPoints.includes("ä¸¥é‡ç¼ºæ–°å®¢")) { theme = "ç ´å†°è¡ŒåŠ¨"; logic = "æ ¸å¿ƒç—›ç‚¹æ˜¯æµé‡ï¼Œé‡ç‚¹åœ¨äºé™ä½é—¨æ§›ï¼Œåˆ¶é€ çˆ†ç‚¹ã€‚"; }

            // Card Logic
            const cards = generateCardMatrix(state.storeType, state.priceRange, avgTicket);
            let designLogic = "åŸºäºæ‚¨çš„åœºé¦†ç±»å‹å’Œå®šä»·åŒºé—´ï¼Œæˆ‘ä»¬è®¾è®¡äº†äº”ç»´ä¸€ä½“çš„å¡é¡¹ç»“æ„ã€‚";
            if(totalMembers < 50) designLogic += "å½“å‰ä¼šå‘˜åŸºæ•°è¾ƒå°ï¼Œé‡ç‚¹åœ¨äºå¼•æµè£‚å˜ã€‚";

            // Render Sections
            
            // 1. Strategy
            document.getElementById('strategyLocation').innerText = `${state.province}${state.city} ${state.district} Â· ${STORE_TYPE_OPTIONS.find(t => t.id === state.storeType).label}`;
            document.getElementById('strategyTheme').innerText = theme;
            document.getElementById('strategyLogic').innerText = logic;

            // 2. Cards
            document.getElementById('cardDesignLogic').innerText = designLogic;
            document.getElementById('cardTableBody').innerHTML = cards.map(c => `
                <tr class="hover:bg-slate-700/30 transition-colors border-b border-slate-700/50">
                    <td class="p-3 align-top"><span class="inline-block px-2 py-1 rounded text-xs font-bold bg-slate-700 text-slate-300">${c.type}</span></td>
                    <td class="p-3 align-top font-bold text-white text-sm">${c.name}</td>
                    <td class="p-3 align-top text-sm text-slate-300">${c.content}</td>
                    <td class="p-3 align-top"><div class="font-bold text-orange-400">${c.price}</div></td>
                    <td class="p-3 align-top text-sm text-slate-300 font-mono text-xs">${c.unit}</div></td>
                    <td class="p-3 align-top text-xs text-slate-300">${c.target}</td>
                    <td class="p-3 align-top text-xs text-slate-400 leading-tight">${c.position}</td>
                </tr>
            `).join('');

            // 3. Math
            document.getElementById('mathLeads').innerText = neededLeads;
            document.getElementById('mathTicket').innerText = `Â¥${avgTicket}`;
            document.getElementById('mathRate').innerText = `${(closeRate * 100)}%`;
            document.getElementById('mathTarget').innerText = `Â¥${parseInt(state.targetRevenue).toLocaleString()}`;
            document.getElementById('mathComment').innerText = `âœ… æµ‹ç®—é€»è¾‘ï¼š${state.targetRevenue} / (${avgTicket} x ${closeRate * 100}%) â‰ˆ ${neededLeads}äººã€‚\nåŸºäºã€${priceOpt.label}ã€‘å®¢å•ä»·ã€‚${totalMembers < 50 ? 'æ–°åº—æœŸå»ºè®®é‡å¼•æµã€‚' : 'ç¨³å®šæœŸå»ºè®®é‡è½¬ä»‹ç»ã€‚'}`;

            // 4. Calendar Content
            updateDailyContent(shopName);

            // 5. Private Scripts
            const pScripts = generatePrivateScripts(state.storeType, shopName);
            document.getElementById('privateScriptsContainer').innerHTML = `
                ${renderScriptRow("ğŸ’€ æ­»å®¢å”¤é†’", "text-slate-400", pScripts.dead, "fa-user-times")}
                ${renderScriptRow("âš¡ å‘†å®¢æ¿€æ´»", "text-orange-400", pScripts.dormant, "fa-bolt")}
                ${renderScriptRow("ğŸŒ± æ½œå®¢èƒŒä¹¦", "text-blue-400", pScripts.potential, "fa-seedling")}
                ${renderScriptRow("ğŸ”¥ æ´»è·ƒè£‚å˜", "text-green-400", pScripts.active, "fa-fire")}
            `;
        }

        function generateCardMatrix(type, rangeId, basePrice) {
            // Logic ported from React
            let multiplier = type === 'studio' ? 1.5 : 1;
            const cards = [
                 { type: "åˆ©æ¶¦ç§æ•™å¡A", name: "ç§æ•™ 10 æ¬¡æ”¹å–„å¡", content: "10 èŠ‚ / 3-4 ä¸ªæœˆ", price: `Â¥${Math.round(basePrice * 0.8)}`, unit: `Â¥${Math.round(basePrice * 0.08)}/èŠ‚`, target: "ä½“æ€/å‡è„‚", position: "é«˜æ¯›åˆ©" },
                 { type: "åˆ©æ¶¦ç§æ•™å¡B", name: "ç§æ•™ 20 æ¬¡èœ•å˜å¡", content: "20 èŠ‚ / 6-8 ä¸ªæœˆ", price: `Â¥${Math.round(basePrice * 1.5)}`, unit: `Â¥${Math.round(basePrice * 0.075)}/èŠ‚`, target: "é«˜å‡€å€¼", position: "é˜¶æ®µæ”¹å˜" },
                 { type: "å°ç­é«˜é˜¶å¡", name: "æ™®æ‹‰æå°ç­å¡", content: "30 èŠ‚ / 6-9 ä¸ªæœˆ", price: `Â¥${Math.round(basePrice * 1.2)}`, unit: `Â¥${Math.round(basePrice * 0.04)}/èŠ‚`, target: "äº§åä¿®å¤", position: "ä¸“æ¡ˆè¯¾ç¨‹" },
                 { type: "å¹´åº¦å°Šäº«å¡", name: "é»‘é‡‘å¹´å¡", content: "å¹´åº¦ç•…ç»ƒ+èµ è¯¾", price: `Â¥${Math.round(basePrice * 2.5)}`, unit: "æœˆå‡ä½", target: "é“ç²‰", position: "ç°é‡‘æµ" },
                 { type: "å®¶åº­/åŒäººå¡", name: "åŒäººå…±äº«å¡", content: "2äººå…±äº«", price: `Â¥${Math.round(basePrice * 3.0)}`, unit: "é«˜æ€§ä»·æ¯”", target: "é—ºèœœ/å¤«å¦»", position: "ç²˜æ€§" }
            ];
            return cards;
        }

        function generatePrivateScripts(type, name) {
            const isHighEnd = type === 'studio' || type === 'mall';
            return {
                dead: isHighEnd ? `ã€${name}Â·è€å‹è®°ã€‘äº²çˆ±çš„ï¼Œå¥½ä¹…ä¸è§...` : `ã€${name}Â·å›å½’ç¤¼ã€‘å§ï¼Œå¥½ä¹…æ²¡è§ä½ äº†ï¼...`,
                dormant: isHighEnd ? `ã€${name}Â·ä¸“å±é‚€çº¦ã€‘å†…æµ‹è¯¾é‚€è¯·...` : `ã€${name}Â·å–Šä½ å›æ¥ã€‘å®ï¼Œæœ€è¿‘æ˜¯ä¸æ˜¯å·æ‡’å•¦ï¼Ÿ...`,
                potential: isHighEnd ? `ã€${name}Â·ä¸“ä¸šè§£ç­”ã€‘æˆ‘æ˜¯åº—é•¿...` : `ã€${name}Â·æ–°äººç¦åˆ©ã€‘å§ï¼Œè€ƒè™‘å¾—æ€ä¹ˆæ ·å•¦ï¼Ÿ...`,
                active: isHighEnd ? `ã€${name}Â·æ„Ÿæ©ç¤¼ã€‘æ‚¨æœ€è¿‘çŠ¶æ€å¤ªæ£’äº†...` : `ã€${name}Â·åˆä¼™äººã€‘å§ï¼Œæ‚¨ç®€ç›´æ˜¯æˆ‘ä»¬çš„æ´»æ‹›ç‰Œ...`
            };
        }

        function renderScriptRow(label, colorClass, content, icon) {
            return `
                <div class="p-6 hover:bg-slate-700/20 transition-colors group">
                    <div class="flex justify-between items-center mb-3">
                        <h4 class="text-sm font-bold flex items-center ${colorClass}">
                            <i class="fas ${icon} w-4 h-4 mr-2"></i> ${label}
                        </h4>
                        <button onclick="copyText(this, '${content.replace(/\n/g, "\\n")}')" class="text-xs flex items-center bg-slate-700 hover:bg-slate-600 text-slate-300 px-2 py-1 rounded transition-colors">
                            <i class="fas fa-copy mr-1"></i> å¤åˆ¶
                        </button>
                    </div>
                    <div class="bg-slate-900 rounded-lg p-4 border border-slate-700 font-mono text-sm text-slate-300 whitespace-pre-line leading-relaxed">${content}</div>
                </div>
            `;
        }

        function changeDate(offset) {
            state.currentDate.setDate(state.currentDate.getDate() + offset);
            const shopName = document.getElementById('studioName').value || 'å¼ºä¸­å¼ºç‘œä¼½';
            updateDailyContent(shopName);
        }

        function updateDailyContent(shopName) {
            const date = state.currentDate;
            const dayIndex = date.getDate();
            const vibe = DAILY_VIBES[dayIndex % 10];
            const dayOfWeek = WEEKLY_THEMES[date.getDay()];
            
            document.getElementById('calendarDateDisplay').innerHTML = `${date.getMonth()+1}æœˆ${date.getDate()}æ—¥ <span class="ml-1 text-xs text-slate-400">${dayOfWeek.day}</span>`;
            document.getElementById('dailyVibeTag').innerText = `ä»Šæ—¥å‰§æœ¬ï¼š${vibe.name}`;

            // 1. Moments
            // Logic to generate 3 lines based on vibe and store type
            let m_c = "", a_c = "", e_c = "";
            if (vibe.name === "ç¡¬æ ¸å¹²è´§æ—¥") {
                m_c = `æ—©å®‰Â·è‡ªæµ‹\nä½ çš„æ–œæ–¹è‚Œä¸ºä»€ä¹ˆåšï¼Ÿ\nå¯èƒ½æ˜¯ç¡è§‰è€¸è‚©ï¼`;
                a_c = `åˆé—´Â·ç§‘æ™®\nä¹…åè…°ç—›ï¼Ÿ\nä¸€ä¸ªåŠ¨ä½œç¼“è§£ï¼ˆè§å›¾ï¼‰ã€‚`;
                e_c = `æ™šå®‰Â·åšæŒ\né‡å˜å¼•èµ·è´¨å˜ã€‚\nåšæŒæ‰“å¡ï¼`;
            } else {
                // Default fallback logic
                m_c = `æ—©å®‰ï¼${dayOfWeek.day}ã€‚\næ–°çš„ä¸€å¤©ä»æ·±å‘¼å¸å¼€å§‹ã€‚\n#${shopName}`;
                a_c = `åˆä¼‘æ—¶é—´ã€‚\næ¥é¦†é‡Œå……ä¸ªç”µå§ã€‚\n#ç‘œä¼½ç”Ÿæ´»`;
                e_c = `æ™šå®‰ã€‚\nå¸ä¸‹ä¸€èº«ç–²æƒ«ã€‚\næ˜å¤©è§ã€‚`;
            }

            const momentsHTML = `
                <div class="relative pl-8 border-l-2 border-slate-700 pb-6">
                    <div class="absolute -left-[9px] top-0 bg-slate-800 border border-slate-600 p-1 rounded-full"><i class="fas fa-sun text-orange-400 text-xs"></i></div>
                    <div class="mb-1 flex items-center"><span class="text-xs font-bold bg-slate-700 text-slate-300 px-2 py-0.5 rounded mr-2">10:00</span><span class="text-sm font-bold text-white">æ—©å®‰Â·${vibe.name}</span></div>
                    <div class="bg-slate-900/80 rounded-lg p-4 border border-slate-700 font-mono text-sm text-slate-300 whitespace-pre-line mt-2">${m_c}</div>
                </div>
                <div class="relative pl-8 border-l-2 border-slate-700 pb-6">
                    <div class="absolute -left-[9px] top-0 bg-slate-800 border border-slate-600 p-1 rounded-full"><i class="fas fa-coffee text-yellow-400 text-xs"></i></div>
                    <div class="mb-1 flex items-center"><span class="text-xs font-bold bg-slate-700 text-slate-300 px-2 py-0.5 rounded mr-2">14:00</span><span class="text-sm font-bold text-white">åˆé—´Â·èƒ½é‡</span></div>
                    <div class="bg-slate-900/80 rounded-lg p-4 border border-slate-700 font-mono text-sm text-slate-300 whitespace-pre-line mt-2">${a_c}</div>
                </div>
                <div class="relative pl-8 border-l-2 border-slate-700">
                    <div class="absolute -left-[9px] top-0 bg-slate-800 border border-slate-600 p-1 rounded-full"><i class="fas fa-moon text-blue-400 text-xs"></i></div>
                    <div class="mb-1 flex items-center"><span class="text-xs font-bold bg-slate-700 text-slate-300 px-2 py-0.5 rounded mr-2">20:00</span><span class="text-sm font-bold text-white">æ™šå®‰Â·${dayOfWeek.day}</span></div>
                    <div class="bg-slate-900/80 rounded-lg p-4 border border-slate-700 font-mono text-sm text-slate-300 whitespace-pre-line mt-2">${e_c}</div>
                </div>
            `;
            document.getElementById('momentsContainer').innerHTML = momentsHTML;

            // 2. Douyin
            document.getElementById('douyinTitle').innerText = `${vibe.name}ï¼š${shopName}çš„${dayOfWeek.day}`;
            document.getElementById('douyinContent').innerText = `ä»Šå¤©æ˜¯${vibe.name}ï¼Œå¸¦å¤§å®¶çœ‹çœ‹æˆ‘ä»¬çš„æ—¥å¸¸ã€‚\n#${shopName} #ç‘œä¼½`;
            document.getElementById('douyinBgm').innerText = "è½»å¿«Vlog / å¡ç‚¹éŸ³ä¹";
            document.getElementById('douyinScript').innerHTML = `
                <div class="flex text-xs border-l-2 border-slate-600 pl-3 py-1"><span class="text-slate-400 font-mono w-12 shrink-0">0-3s</span><div class="text-slate-300"><span class="text-orange-400 font-bold">ç”»é¢ï¼š</span>å¸ç›å¼€åœº <span class="text-blue-400 font-bold ml-1">å£°éŸ³ï¼š</span>é‡éŸ³/æé—®</div></div>
                <div class="flex text-xs border-l-2 border-slate-600 pl-3 py-1"><span class="text-slate-400 font-mono w-12 shrink-0">3-8s</span><div class="text-slate-300"><span class="text-orange-400 font-bold">ç”»é¢ï¼š</span>æ ¸å¿ƒå±•ç¤º <span class="text-blue-400 font-bold ml-1">å£°éŸ³ï¼š</span>BGMåˆ‡å…¥</div></div>
            `;

            // 3. XHS
            document.getElementById('xhsTitle').innerText = `${vibe.name} | ${shopName}æ—¥è®°`;
            document.getElementById('xhsContent').innerText = `ä»Šå¤©æ˜¯${dayOfWeek.day}ï¼Œåˆ†äº«ä¸€ä¸ª${vibe.name}ä¸»é¢˜ï¼\nğŸ“${state.district}`;
        }

        // --- Utilities ---
        function copyText(btnOrId, text) {
            const content = typeof btnOrId === 'string' ? document.getElementById(btnOrId).innerText : text;
            navigator.clipboard.writeText(content).then(() => {
                const btn = typeof btnOrId === 'string' ? document.querySelector(`button[onclick="copyText('${btnOrId}')"]`) : btnOrId;
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check text-green-500"></i> å·²å¤åˆ¶';
                setTimeout(() => btn.innerHTML = originalHtml, 2000);
            });
        }

        function askAI(presetQ) {
            const q = presetQ || document.getElementById('qaInput').value;
            if (!q) return;
            
            const responseBox = document.getElementById('aiResponseContainer');
            const responseText = document.getElementById('aiResponseText');
            const btn = document.getElementById('qaBtn');
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            // Mock AI Logic
            let answer = "è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ã€‚å»ºè®®æ‚¨æ¢³ç†è´¢åŠ¡æ¨¡å‹ã€‚";
            if(q.includes("å¼•æµ")) answer = "ã€æ–°åº—å¼•æµä¸‰æ¿æ–§ã€‘\n1. åœ°æ¨å‡çº§ï¼šå¸¦ä½“æµ‹ä»ªå»å°åŒºé—¨å£ã€‚\n2. å¼‚ä¸šåˆä½œï¼šæ‰¾å‘¨è¾¹ç¾ç”²åº—äº’æ¨ã€‚\n3. å›¢è´­å¼•æµï¼š9.9å…ƒä½“éªŒè¯¾åªä¸ºç•™èµ„ã€‚";
            if(q.includes("ç»­è´¹") || q.includes("è€ä¼šå‘˜")) answer = "ã€æå‡ç»­è´¹ç‡ã€‘\n1. è€—å¡é¢„è­¦ï¼šå‰©3èŠ‚è¯¾å¿…é¡»æé†’ã€‚\n2. æƒ…æ„Ÿè´¦æˆ·ï¼šè¿‡èŠ‚é€å°ç¤¼ç‰©ã€‚\n3. æ•ˆæœå¤–åŒ–ï¼šæ¯å­£åº¦åšä½“æµ‹å¯¹æ¯”ã€‚";
            
            setTimeout(() => {
                responseBox.classList.remove('hidden');
                responseText.innerText = answer;
                btn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                document.getElementById('qaInput').value = '';
            }, 1000);
        }

        // Start
        init();

    </script>
</body>
</html>